<<<<<<< HEAD
"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf")),_inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_react=_interopRequireDefault(require("react")),_reactDom=_interopRequireDefault(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_jquery=_interopRequireDefault(require("jquery")),_Constant=_interopRequireDefault(require("./Constant")),_GlobalContext=require("./GlobalContext");function forEach(e,t){for(var i=0,a=e.length;i<a;i++)t&&t.call(e[i],e[i],i)}function go(e){this.ctmobile.router.go(e)}function createPageDOM(){var e=this;this._pDom.setAttribute("id",this.pageId),forEach(this._pDom.querySelectorAll("[id]"),function(){this.setAttribute("id",e.id+this.getAttribute("id"))}),forEach(this._pDom.querySelectorAll("label[for]"),function(){this.setAttribute("for",e.id+this.getAttribute("for"))}),forEach(this._pDom.querySelectorAll("input[list]"),function(){this.setAttribute("list",e.id+this.getAttribute("list"))}),forEach(this._pDom.querySelectorAll("datalist[id]"),function(){this.setAttribute("id",e.id+this.getAttribute("id"))}),this.transition=this.ctmobile.getPageConfigAttribute(this.pageId,"transition"),addEventListeners.call(this);var t=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterAction"),i=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterCategorys"),a=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterPriority");t&&this.ctmobile.registerReceiver({el:this._pDom,action:t,priority:a?parseInt(a):0,categorys:i?i.split(" "):[]},this.pageReceiver,this)}function layout(){slideByTransition.call(this,this.transition,"reset",0)}function addEventListeners(){var t=this;function e(e){console.log(_Constant.default._debugger,"------------------------------onTransitionAndAnimationEnd"),"webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||t.pageTransitionType&&("start"===t.pageTransitionType?(delete t.pageTransitionType,pageStartTransitionEndCallback.call(t,e)):"finish"===t.pageTransitionType&&(delete t.pageTransitionType,pageFinishTransitioneEndCallback.call(t,e)))}t.getPageJO().on({pageBeforeShow:t.pageBeforeShow.bind(t),pageShow:t.pageShow.bind(t),pageAfterShow:t.pageAfterShow.bind(t),pageBeforePause:t.pageBeforePause.bind(t),pageAfterPause:t.pageAfterPause.bind(t),pageBeforeRestore:t.pageBeforeRestore.bind(t),pageRestore:t.pageRestore.bind(t),pageAfterRestore:t.pageAfterRestore.bind(t),pageBeforeDestroy:t.pageBeforeDestroy.bind(t),pageResult:t.pageResult.bind(t),pageReceiver:t.pageReceiver.bind(t)}),t.getPageDOM().addEventListener("webkitTransitionEnd",e,!1),t.getPageDOM().addEventListener("webkitAnimationEnd",e,!1)}function pageFinishTransitioneEndCallback(e){var t=this;if(!("webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role"))){e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialHide"),t.getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1;var i=t.ctmobile.getPageConfigAttribute(t.pageId,"mode");if(-1===i.toLowerCase().indexOf("singleinstance"))_reactDom.default.unmountComponentAtNode(t.getPageDOM())&&t.getPageDOM().parentNode.removeChild(t.getPageDOM());if(1<t.ctmobile.getHistoryLength()){var a=t.ctmobile.getHistoryLength()-2;t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(a).getPageDOM(),"pageAfterRestore"),-1!==i.toLowerCase().lastIndexOf("result")&&t.resultIntent&&t.resultIntent.resultCode&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(a).getPageDOM(),"pageResult",[t.resultIntent.resultCode,t.resultIntent.bundle])}t.ctmobile.router.removeLastPage(),t.pageTransitionEndCallback&&t.pageTransitionEndCallback()}}function pageStartTransitionEndCallback(e){var t=this;"webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||(e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialShow"),t.ctmobile.getLastPage().getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1,t.ctmobile.router.addPage(t),t.ctmobile.fireEvent(t.getPageDOM(),"pageAfterShow"),2<=t.ctmobile.getHistoryLength()&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(t.ctmobile.getHistoryLength()-2).getPageDOM(),"pageAfterPause"),t.pageTransitionEndCallback&&t.pageTransitionEndCallback())}function slideByTransition(e,t,i,a){var n=this,s=0,r=0;"reset"===t?function(){new RegExp(/.+left/g).exec(e)?s="100%":new RegExp(/.+right/g).exec(e)?s="-100%":new RegExp(/.+up/g).exec(e)?r="100%":new RegExp(/.+down/g).exec(e)&&(r="-100%"),0===e.indexOf("wx")&&0!==i?(delete n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2).pageTransitionType,slide.call(n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2),0,0,i/2)):0===e.indexOf("push")&&0!==i&&(delete n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2).pageTransitionType,slide.call(n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2),0,0,i)),0===e.indexOf("material")?0!==i&&(a&&a(),this.getPageDOM().classList.add("materialHide")):slide.call(this,s,r,i,a)}.call(n):function(){0===e.indexOf("wx")&&0!==i?(delete n.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"-20%",r,i/2):new RegExp(/.+right/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"20%",r,i/2):new RegExp(/.+up/g).exec(e)?slide.call(n.ctmobile.getLastPage(),s,"-20%",i/2):new RegExp(/.+down/g).exec(e)&&slide.call(n.ctmobile.getLastPage(),s,"20%",i/2)):0===e.indexOf("push")&&0!==i&&(delete n.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"-100%",r,i):new RegExp(/.+right/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"100%",r,i):new RegExp(/.+up/g).exec(e)?slide.call(n.ctmobile.getLastPage(),s,"-100%",i):new RegExp(/.+down/g).exec(e)&&slide.call(n.ctmobile.getLastPage(),s,"100%",i)),0===e.indexOf("material")?0!==i&&(a&&a(),n.getPageDOM().classList.add("materialShow")):slide.call(this,s,r,i,a)}.call(n)}function slide(e,t,i,a){var n=this;function s(){n.getPageJO().css({transform:"translate3d("+e+","+t+",0)","-webkit-transform":"translate3d("+e+","+t+",0)",transition:"transform "+i+"ms cubic-bezier(0.1,0.25,0.1,1)","-webkit-transition":"transform "+i+"ms cubic-bezier(0.1,0.25,0.1,1)"})}a&&a(),0===i?s():window.setTimeout(s,100)}var Page={create:function(o){return function(i){var e=function(e){function r(e){var t;(0,_classCallCheck2.default)(this,r),t=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(r).call(this,e));var i=e.ctmobile,a=e.id,n=e.config,s=void 0===n?{}:n;return Object.assign((0,_assertThisInitialized2.default)((0,_assertThisInitialized2.default)(t)),{ctmobile:i,config:s,_pDom:o,id:a,pageId:a.substring(0,a.lastIndexOf("_")),transition:"material",changeKey:!1,pageTransitionType:null,pageTransitionEndCallback:null}),createPageDOM.call((0,_assertThisInitialized2.default)((0,_assertThisInitialized2.default)(t))),layout.call((0,_assertThisInitialized2.default)((0,_assertThisInitialized2.default)(t))),t}return(0,_inherits2.default)(r,e),(0,_createClass2.default)(r,[{key:"componentDidMount",value:function(){this.ins&&this.ins.pageCreate&&this.ins.pageCreate();var e=this.getPageId();-1!==this.ctmobile.getPageConfigAttribute(e,"mode").toLowerCase().indexOf("singleinstance")&&(this.ctmobile.getSingleInstance(e)||(this.ctmobile.singleInstances[e]=this)),this.props.callback&&this.props.callback(this)}},{key:"pageBeforeShow",value:function(e){this.ins&&this.ins.pageBeforeShow&&this.ins.pageBeforeShow(e)}},{key:"pageShow",value:function(e){this.ins&&this.ins.pageShow&&this.ins.pageShow(e)}},{key:"pageAfterShow",value:function(e){this.ins&&this.ins.pageAfterShow&&this.ins.pageAfterShow(e)}},{key:"pageBeforePause",value:function(e){this.ins&&this.ins.pageBeforePause&&this.ins.pageBeforePause(e)}},{key:"pageAfterPause",value:function(e){this.ins&&this.ins.pageAfterPause&&this.ins.pageAfterPause(e)}},{key:"pageBeforeRestore",value:function(e){this.ins&&this.ins.pageBeforeRestore&&this.ins.pageBeforeRestore(e)}},{key:"pageRestore",value:function(e){this.ins&&this.ins.pageRestore&&this.ins.pageRestore(e)}},{key:"pageAfterRestore",value:function(e){this.ins&&this.ins.pageAfterRestore&&this.ins.pageAfterRestore(e)}},{key:"pageBeforeDestroy",value:function(e){this.ins&&this.ins.pageBeforeDestroy&&this.ins.pageBeforeDestroy(e)}},{key:"pageResult",value:function(e,t,i){this.ins&&this.ins.pageResult&&this.ins.pageResult(e,t,i)}},{key:"pageReceiver",value:function(e,t){this.ins&&this.ins.pageReceiver&&this.ins.pageReceiver(e,t)}},{key:"start",value:function(e,t){var i=this;i.changeKey||(i.changeKey=!0,i.pageTransitionType="start",i.pageTransitionEndCallback=t,0!==i.ctmobile.getHistoryLength()&&i.ctmobile.fireEvent(i.ctmobile.getLastPage().getPageDOM(),"pageBeforePause"),i.ctmobile.fireEvent(i.getPageDOM(),"pageBeforeShow"),0!==e&&(i.ctmobile.maskDOM.style.display="block"),i.getPageDOM().classList.add("active"),i.getPageDOM().style.zIndex=++i.ctmobile.zIndex,i.ctmobile.fireEvent(i.getPageDOM(),"pageShow"),slideByTransition.call(i,i.transition,"show",0===e?0:_Constant.default._SLIDEDURATION),0===e&&(i.ctmobile.router.addPage(i),i.changeKey=!1,i.ctmobile.fireEvent(i.getPageDOM(),"pageAfterShow"),t&&t()))}},{key:"finish",value:function(e,t,i){var a=this;if(!a.changeKey){a.changeKey=!0,a.pageTransitionType="finish",a.ctmobile.zIndex--,a.pageTransitionEndCallback=t;var n=a.ctmobile.getPageConfigAttribute(a.getPageId(),"mode");-1===n.toLowerCase().indexOf("singleinstance")?(a.ctmobile.fireEvent(a.getPageDOM(),"pageBeforeDestroy"),a.ctmobile.unregisterReceiverByDom(a.getPageDOM())):a.ctmobile.fireEvent(a.getPageDOM(),"pageAfterPause");var s=a.ctmobile.getHistoryLength()-2;if(!(1<a.ctmobile.getHistoryLength())||i&&i.reload||a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(s).getPageDOM(),"pageBeforeRestore"),0!==e&&(a.ctmobile.maskDOM.style.display="block"),!(1<a.ctmobile.getHistoryLength())||i&&i.reload||(a.ctmobile.getPageByIndex(s).getPageDOM().classList.add("active"),a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(s).getPageDOM(),"pageRestore")),slideByTransition.call(this,this.transition,"reset",0===e?0:_Constant.default._SLIDEDURATION),0===e){if(a.getPageDOM().classList.remove("active"),a.changeKey=!1,-1===n.toLowerCase().indexOf("singleinstance"))_reactDom.default.unmountComponentAtNode(a.getPageDOM())&&a.getPageDOM().parentNode.removeChild(a.getPageDOM());!(1<a.ctmobile.getHistoryLength())||i&&i.reload||(a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(s).getPageDOM(),"pageAfterRestore"),-1!==n.toLowerCase().lastIndexOf("result")&&a.resultIntent&&a.resultIntent.resultCode&&a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(s).getPageDOM(),"pageResult",[a.resultIntent.resultCode,a.resultIntent.bundle])),1<a.ctmobile.getHistoryLength()&&i&&i.reload?a.ctmobile.router.removePageByIndex(s,1):a.ctmobile.router.removeLastPage(),t&&t()}}}},{key:"getPageDOM",value:function(){return this._pDom}},{key:"getPageJO",value:function(){return this._pJO||(this._pJO=(0,_jquery.default)(this.getPageDOM())),this._pJO}},{key:"getId",value:function(){return this.id}},{key:"getPageId",value:function(){return this.pageId}},{key:"setRequest",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.requestIntent={requestCode:e,bundle:t}}},{key:"getRequest",value:function(e){return this.ctmobile.getRequest(this)}},{key:"setResult",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.resultIntent={resultCode:e,bundle:t}}},{key:"getResult",value:function(e){return this.resultIntent}},{key:"over",value:function(){go.call(this,-1)}},{key:"getCtMobile",value:function(){return this.ctmobile}},{key:"render",value:function(){var t=this,e={parent:this,_pDom:this._pDom,pageId:this.pageId,getInstance:function(e){t.ins=e}};return _react.default.createElement(_GlobalContext.Provider,{value:this.getCtMobile()},_react.default.createElement(i,(0,_extends2.default)({},e,this.props)))}}]),r}(_react.default.Component);return i.propTypes={ctmobile:_propTypes.default.object,id:_propTypes.default.string,config:_propTypes.default.object,callback:_propTypes.default.func,parent:_propTypes.default.object,_pDom:_propTypes.default.object,pageId:_propTypes.default.string,getInstance:_propTypes.default.func},e.propTypes={ctmobile:_propTypes.default.object,id:_propTypes.default.string,config:_propTypes.default.object,callback:_propTypes.default.func},e}},WrappedPage:function(e){function t(e){return(0,_classCallCheck2.default)(this,t),(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(t).call(this,e))}return(0,_inherits2.default)(t,e),(0,_createClass2.default)(t,[{key:"componentDidMount",value:function(){this.props.getInstance&&this.props.getInstance(this)}}]),t}(_react.default.Component)},_default=Page;exports.default=_default;
=======
"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_jquery=_interopRequireDefault(require("jquery")),_Constant=_interopRequireDefault(require("./Constant"));function forEach(e,t){for(var i=0,a=e.length;i<a;i++)t&&t.call(e[i],e[i],i)}function go(e){this.ctmobile.router.go(e)}function createPageDOM(){var e=this;this._pDom.setAttribute("id",this.pageId),forEach(this._pDom.querySelectorAll("[id]"),function(){this.setAttribute("id",e.id+this.getAttribute("id"))}),forEach(this._pDom.querySelectorAll("label[for]"),function(){this.setAttribute("for",e.id+this.getAttribute("for"))}),forEach(this._pDom.querySelectorAll("input[list]"),function(){this.setAttribute("list",e.id+this.getAttribute("list"))}),forEach(this._pDom.querySelectorAll("datalist[id]"),function(){this.setAttribute("id",e.id+this.getAttribute("id"))}),this.transition=this.ctmobile.getPageConfigAttribute(this.pageId,"transition"),addEventListeners.call(this);var t=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterAction"),i=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterCategorys"),a=this.ctmobile.getPageConfigAttribute(this.pageId,"intentfilterPriority");t&&this.ctmobile.registerReceiver({el:this._pDom,action:t,priority:a?parseInt(a):0,categorys:i?i.split(" "):[]},this.pageReceiver,this)}function layout(){slideByTransition.call(this,this.transition,"reset",0)}function addEventListeners(){var t=this;function e(e){console.log(_Constant.default._debugger,"------------------------------onTransitionAndAnimationEnd"),"webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||t.pageTransitionType&&("start"===t.pageTransitionType?(delete t.pageTransitionType,pageStartTransitionEndCallback.call(t,e)):"finish"===t.pageTransitionType&&(delete t.pageTransitionType,pageFinishTransitioneEndCallback.call(t,e)))}t.getPageJO().on({pageBeforeShow:t.pageBeforeShow.bind(t),pageShow:t.pageShow.bind(t),pageAfterShow:t.pageAfterShow.bind(t),pageBeforePause:t.pageBeforePause.bind(t),pageAfterPause:t.pageAfterPause.bind(t),pageBeforeRestore:t.pageBeforeRestore.bind(t),pageRestore:t.pageRestore.bind(t),pageAfterRestore:t.pageAfterRestore.bind(t),pageBeforeDestroy:t.pageBeforeDestroy.bind(t),pageResult:t.pageResult.bind(t),pageReceiver:t.pageReceiver.bind(t)}),t.getPageDOM().addEventListener("webkitTransitionEnd",e,!1),t.getPageDOM().addEventListener("webkitAnimationEnd",e,!1)}function pageFinishTransitioneEndCallback(e){var t=this;if(!("webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role"))){e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialHide"),t.getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1;var i=t.ctmobile.getPageConfigAttribute(t.pageId,"mode");if(-1===i.toLowerCase().indexOf("singleinstance")&&t.$destroy(),1<t.ctmobile.getHistoryLength()){var a=t.ctmobile.getHistoryLength()-2;t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(a).getPageDOM(),"pageAfterRestore"),-1!==i.toLowerCase().lastIndexOf("result")&&t.resultIntent&&t.resultIntent.resultCode&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(a).getPageDOM(),"pageResult",[t.resultIntent.resultCode,t.resultIntent.bundle])}t.ctmobile.router.removeLastPage(),t.pageTransitionEndCallback&&t.pageTransitionEndCallback()}}function pageStartTransitionEndCallback(e){var t=this;"webkitTransitionEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||"webkitAnimationEnd"===e.type&&"page"!==e.target.getAttribute("data-ct-data-role")||(e.stopPropagation(),e.preventDefault(),t.getPageDOM().classList.remove("materialShow"),t.ctmobile.getLastPage().getPageDOM().classList.remove("active"),t.ctmobile.maskDOM.style.display="none",t.changeKey=!1,t.ctmobile.router.addPage(t),t.ctmobile.fireEvent(t.getPageDOM(),"pageAfterShow"),2<=t.ctmobile.getHistoryLength()&&t.ctmobile.fireEvent(t.ctmobile.getPageByIndex(t.ctmobile.getHistoryLength()-2).getPageDOM(),"pageAfterPause"),t.pageTransitionEndCallback&&t.pageTransitionEndCallback())}function slideByTransition(e,t,i,a){var n=this,r=0,s=0;"reset"===t?function(){new RegExp(/.+left/g).exec(e)?r="100%":new RegExp(/.+right/g).exec(e)?r="-100%":new RegExp(/.+up/g).exec(e)?s="100%":new RegExp(/.+down/g).exec(e)&&(s="-100%"),0===e.indexOf("wx")&&0!==i?(delete n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2).pageTransitionType,slide.call(n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2),0,0,i/2)):0===e.indexOf("push")&&0!==i&&(delete n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2).pageTransitionType,slide.call(n.ctmobile.getPageByIndex(n.ctmobile.getHistoryLength()-2),0,0,i)),0===e.indexOf("material")?0!==i&&(a&&a(),this.getPageDOM().classList.add("materialHide")):slide.call(this,r,s,i,a)}.call(n):function(){0===e.indexOf("wx")&&0!==i?(delete n.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"-20%",s,i/2):new RegExp(/.+right/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"20%",s,i/2):new RegExp(/.+up/g).exec(e)?slide.call(n.ctmobile.getLastPage(),r,"-20%",i/2):new RegExp(/.+down/g).exec(e)&&slide.call(n.ctmobile.getLastPage(),r,"20%",i/2)):0===e.indexOf("push")&&0!==i&&(delete n.ctmobile.getLastPage().pageTransitionType,new RegExp(/.+left/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"-100%",s,i):new RegExp(/.+right/g).exec(e)?slide.call(n.ctmobile.getLastPage(),"100%",s,i):new RegExp(/.+up/g).exec(e)?slide.call(n.ctmobile.getLastPage(),r,"-100%",i):new RegExp(/.+down/g).exec(e)&&slide.call(n.ctmobile.getLastPage(),r,"100%",i)),0===e.indexOf("material")?0!==i&&(a&&a(),n.getPageDOM().classList.add("materialShow")):slide.call(this,r,s,i,a)}.call(n)}function slide(e,t,i,a){var n=this;function r(){n.getPageJO().css({transform:"translate3d("+e+","+t+",0)","-webkit-transform":"translate3d("+e+","+t+",0)",transition:"transform "+i+"ms cubic-bezier(0.1,0.25,0.1,1)","-webkit-transition":"transform "+i+"ms cubic-bezier(0.1,0.25,0.1,1)"})}a&&a(),0===i?r():window.setTimeout(r,100)}var page=function e(t){(0,_classCallCheck2.default)(this,e);var i=t.ctmobile,a=t.id,n=t.config,r=void 0===n?{}:n,s=t.el,o=t.callback;Object.assign(this,{methods:{pageBeforeShow:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageBeforeShow&&this.$children[0].pageBeforeShow(e)},pageShow:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageShow&&this.$children[0].pageShow(e)},pageAfterShow:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageAfterShow&&this.$children[0].pageAfterShow(e)},pageBeforePause:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageBeforePause&&this.$children[0].pageBeforePause(e)},pageAfterPause:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageAfterPause&&this.$children[0].pageAfterPause(e)},pageBeforeRestore:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageBeforeRestore&&this.$children[0].pageBeforeRestore(e)},pageRestore:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageRestore&&this.$children[0].pageRestore(e)},pageAfterRestore:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageAfterRestore&&this.$children[0].pageAfterRestore(e)},pageBeforeDestroy:function(e){this.$children&&1===this.$children.length&&this.$children[0].pageBeforeDestroy&&this.$children[0].pageBeforeDestroy(e)},pageResult:function(e,t,i){this.$children&&1===this.$children.length&&this.$children[0].pageResult&&this.$children[0].pageResult(e,t,i)},pageReceiver:function(e,t){this.$children&&1===this.$children.length&&this.$children[0].pageReceiver&&this.$children[0].pageReceiver(e,t)},start:function(e,t){var i=this;i.changeKey||(i.changeKey=!0,i.pageTransitionType="start",i.pageTransitionEndCallback=t,0!==i.ctmobile.getHistoryLength()&&i.ctmobile.fireEvent(i.ctmobile.getLastPage().getPageDOM(),"pageBeforePause"),i.ctmobile.fireEvent(i.getPageDOM(),"pageBeforeShow"),0!==e&&(i.ctmobile.maskDOM.style.display="block"),i.getPageDOM().classList.add("active"),i.getPageDOM().style.zIndex=++i.ctmobile.zIndex,i.ctmobile.fireEvent(i.getPageDOM(),"pageShow"),slideByTransition.call(i,i.transition,"show",0===e?0:_Constant.default._SLIDEDURATION),0===e&&(i.ctmobile.router.addPage(i),i.changeKey=!1,i.ctmobile.fireEvent(i.getPageDOM(),"pageAfterShow"),t&&t()))},finish:function(e,t,i){var a=this;if(!a.changeKey){a.changeKey=!0,a.pageTransitionType="finish",a.ctmobile.zIndex--,a.pageTransitionEndCallback=t;var n=a.ctmobile.getPageConfigAttribute(a.getPageId(),"mode");-1===n.toLowerCase().indexOf("singleinstance")?(a.ctmobile.fireEvent(a.getPageDOM(),"pageBeforeDestroy"),a.ctmobile.unregisterReceiverByDom(a.getPageDOM())):a.ctmobile.fireEvent(a.getPageDOM(),"pageAfterPause");var r=a.ctmobile.getHistoryLength()-2;!(1<a.ctmobile.getHistoryLength())||i&&i.reload||a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(r).getPageDOM(),"pageBeforeRestore"),0!==e&&(a.ctmobile.maskDOM.style.display="block"),!(1<a.ctmobile.getHistoryLength())||i&&i.reload||(a.ctmobile.getPageByIndex(r).getPageDOM().classList.add("active"),a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(r).getPageDOM(),"pageRestore")),slideByTransition.call(this,this.transition,"reset",0===e?0:_Constant.default._SLIDEDURATION),0===e&&(a.getPageDOM().classList.remove("active"),a.changeKey=!1,-1===n.toLowerCase().indexOf("singleinstance")&&a.$destroy(),!(1<a.ctmobile.getHistoryLength())||i&&i.reload||(a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(r).getPageDOM(),"pageAfterRestore"),-1!==n.toLowerCase().lastIndexOf("result")&&a.resultIntent&&a.resultIntent.resultCode&&a.ctmobile.fireEvent(a.ctmobile.getPageByIndex(r).getPageDOM(),"pageResult",[a.resultIntent.resultCode,a.resultIntent.bundle])),1<a.ctmobile.getHistoryLength()&&i&&i.reload?a.ctmobile.router.removePageByIndex(r,1):a.ctmobile.router.removeLastPage(),t&&t())}},getPageDOM:function(){return this._pDom},getPageJO:function(){return this._pJO||(this._pJO=(0,_jquery.default)(this.getPageDOM())),this._pJO},getId:function(){return this.id},getPageId:function(){return this.pageId},setRequest:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.requestIntent={requestCode:e,bundle:t}},getRequest:function(e){return this.ctmobile.getRequest(this)},setResult:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.resultIntent={resultCode:e,bundle:t}},getResult:function(e){return this.resultIntent},over:function(){go.call(this,-1)},getCtMobile:function(){return this.ctmobile}},created:function(){Object.assign(this,{ctmobile:i,config:r,_pDom:s,id:a,callback:o,pageId:a.substring(0,a.lastIndexOf("_")),transition:"material",changeKey:!1,pageTransitionType:null,pageTransitionEndCallback:null}),createPageDOM.call(this),layout.call(this)},mounted:function(){this.$children&&1===this.$children.length&&this.$children[0].pageCreate&&this.$children[0].pageCreate();var e=this.getPageId();-1!==this.ctmobile.getPageConfigAttribute(e,"mode").toLowerCase().indexOf("singleinstance")&&(this.ctmobile.getSingleInstance(e)||(this.ctmobile.singleInstances[e]=this)),this.callback&&this.callback(this)},destroyed:function(){this.getPageDOM().parentNode.removeChild(this.getPageDOM())}})};exports.default=page;
>>>>>>> develop
